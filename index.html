<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zwaanshals Schoonmaak Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        const { useState, useEffect } = React;

        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCy18JxgaB2P-mL-WeKu36XSzykhYi-ypY",
            authDomain: "schoonmaak-tracker.firebaseapp.com",
            databaseURL: "https://schoonmaak-tracker-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "schoonmaak-tracker",
            storageBucket: "schoonmaak-tracker.firebasestorage.app",
            messagingSenderId: "276714806125",
            appId: "1:276714806125:web:4394e4d2412905c81e9864"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Simple icon components using SVG
        const Check = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );

        const RotateCcw = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="1 4 1 10 7 10"></polyline>
                <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
            </svg>
        );

        const History = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );

        const Settings = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m5.66-13l-4.24 4.24M10.34 13.76 6.1 18M23 12h-6m-6 0H1m18.66 5-4.24-4.24M10.34 10.24 6.1 6"></path>
            </svg>
        );

        const ChevronLeft = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        );

        const ChevronRight = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        );

        const X = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const Clock = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );

        const Activity = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
        );

        // Helper functions
        const getWeekNumber = (date) => {
            const firstJan = new Date(date.getFullYear(), 0, 1);
            const days = Math.floor((date - firstJan) / (24 * 60 * 60 * 1000));
            return Math.ceil((days + firstJan.getDay() + 1) / 7);
        };

        const getWeekDateRange = (weekNum, year) => {
            // Get first day of the year
            const firstJan = new Date(year, 0, 1);
            
            // Calculate days to first Monday of the year
            const firstMonday = new Date(firstJan);
            const dayOfWeek = firstJan.getDay();
            const daysToMonday = dayOfWeek === 0 ? 1 : (8 - dayOfWeek) % 7 + 1;
            firstMonday.setDate(firstJan.getDate() + daysToMonday);
            
            // Calculate Monday of target week
            const monday = new Date(firstMonday);
            monday.setDate(firstMonday.getDate() + (weekNum - 1) * 7);
            
            // Calculate Sunday (6 days after Monday)
            const sunday = new Date(monday);
            sunday.setDate(monday.getDate() + 6);
            
            const formatDate = (date) => {
                return `${date.getDate()}/${date.getMonth() + 1}`;
            };
            
            return `${formatDate(monday)} - ${formatDate(sunday)}`;
        };

        const getNextSunday = () => {
            const now = new Date();
            const dayOfWeek = now.getDay();
            const daysUntilSunday = dayOfWeek === 0 ? 7 : 7 - dayOfWeek;
            const sunday = new Date(now);
            sunday.setDate(now.getDate() + daysUntilSunday);
            sunday.setHours(23, 59, 59, 999);
            return sunday;
        };

        const getTimeUntilDeadline = () => {
            const now = new Date();
            const sunday = getNextSunday();
            const diff = sunday - now;
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            
            if (days > 0) {
                return `${days} dag${days !== 1 ? 'en' : ''}`;
            } else if (hours > 0) {
                return `${hours} uur`;
            } else {
                return "Bijna voorbij!";
            }
        };

        const formatTimestamp = (timestamp) => {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);

            if (minutes < 1) return 'Zojuist';
            if (minutes < 60) return `${minutes} min geleden`;
            if (hours < 24) return `${hours} uur geleden`;
            if (days < 7) return `${days} dag${days !== 1 ? 'en' : ''} geleden`;
            
            return date.toLocaleDateString('nl-NL', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' });
        };

        function CleaningTracker() {
            const [currentView, setCurrentView] = useState('tracker');
            const [currentUser, setCurrentUser] = useState(() => {
                return localStorage.getItem('currentUser') || '';
            });
            const [showUserPicker, setShowUserPicker] = useState(!localStorage.getItem('currentUser'));
            const [tasks, setTasks] = useState({
                woonkamer: false,
                keuken: false,
                vuilnis: false
            });
            
            const [history, setHistory] = useState([]);
            const [activityLog, setActivityLog] = useState([]);
            
            const [manualAssignments, setManualAssignments] = useState({
                woonkamer: null,
                keuken: null,
                vuilnis: null
            });

            const [showClearConfirm, setShowClearConfirm] = useState(false);
            const [trackedWeek, setTrackedWeek] = useState(getWeekNumber(new Date()));
            const [isLoading, setIsLoading] = useState(true);
            const [timeUntilDeadline, setTimeUntilDeadline] = useState(getTimeUntilDeadline());

            const roommates = ['Sam', 'Roel', 'Stijn', 'Tom', 'Maxim'];

            // Update deadline timer
            useEffect(() => {
                const interval = setInterval(() => {
                    setTimeUntilDeadline(getTimeUntilDeadline());
                }, 60000); // Update every minute
                return () => clearInterval(interval);
            }, []);

            // Load data from Firebase and set up real-time listeners
            useEffect(() => {
                // Listen to tasks
                const tasksRef = database.ref('tasks');
                tasksRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setTasks(data);
                    }
                    setIsLoading(false);
                });

                // Listen to history
                const historyRef = database.ref('history');
                historyRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setHistory(data);
                    } else {
                        setHistory([]);
                    }
                });

                // Listen to activity log
                const activityRef = database.ref('activity');
                activityRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setActivityLog(data);
                    } else {
                        setActivityLog([]);
                    }
                });

                // Listen to manual assignments
                const assignmentsRef = database.ref('manualAssignments');
                assignmentsRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setManualAssignments(data);
                    }
                });

                // Listen to tracked week
                const weekRef = database.ref('trackedWeek');
                weekRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setTrackedWeek(data);
                    }
                });

                // Cleanup listeners on unmount
                return () => {
                    tasksRef.off();
                    historyRef.off();
                    activityRef.off();
                    assignmentsRef.off();
                    weekRef.off();
                };
            }, []);

            const logActivity = (action, task, status) => {
                const activity = {
                    user: currentUser,
                    action: action,
                    task: task,
                    status: status,
                    timestamp: Date.now()
                };
                const newActivity = [activity, ...activityLog].slice(0, 100); // Keep last 100 activities
                database.ref('activity').set(newActivity);
            };

            const updateTasks = (newTasks) => {
                database.ref('tasks').set(newTasks);
            };

            const updateHistory = (newHistory) => {
                database.ref('history').set(newHistory);
            };

            const updateManualAssignments = (newAssignments) => {
                database.ref('manualAssignments').set(newAssignments);
            };

            const updateTrackedWeek = (newWeek) => {
                database.ref('trackedWeek').set(newWeek);
            };

            const selectUser = (user) => {
                setCurrentUser(user);
                localStorage.setItem('currentUser', user);
                setShowUserPicker(false);
            };

            const currentYear = new Date().getFullYear();
            const isEvenWeek = trackedWeek % 2 === 0;

            const defaultAssignments = {
                woonkamer: isEvenWeek ? 'Roel' : 'Stijn',
                keuken: isEvenWeek ? 'Tom' : 'Maxim',
                vuilnis: 'Sam'
            };

            const assignments = {
                woonkamer: manualAssignments.woonkamer || defaultAssignments.woonkamer,
                keuken: manualAssignments.keuken || defaultAssignments.keuken,
                vuilnis: manualAssignments.vuilnis || defaultAssignments.vuilnis
            };

            const nextWeek = {
                woonkamer: isEvenWeek ? 'Stijn' : 'Roel',
                keuken: isEvenWeek ? 'Maxim' : 'Tom',
                vuilnis: 'Sam'
            };

            const toggleTask = (task) => {
                const newStatus = !tasks[task];
                const newTasks = {
                    ...tasks,
                    [task]: newStatus
                };
                updateTasks(newTasks);
                logActivity(
                    newStatus ? 'afgevinkt' : 'uitgevinkt',
                    task === 'woonkamer' ? 'Woonkamer' : task === 'keuken' ? 'Keuken' : 'Doeken/Vuilnis',
                    newStatus
                );
            };

            const completeWeek = (forceComplete = false) => {
                const weekData = {
                    weekNumber: trackedWeek,
                    year: currentYear,
                    dateRange: getWeekDateRange(trackedWeek, currentYear),
                    completedDate: new Date().toISOString(),
                    assignments: { ...assignments },
                    tasks: { ...tasks },
                    forced: forceComplete
                };
                
                const newHistory = [weekData, ...history];
                updateHistory(newHistory);
                
                updateTasks({
                    woonkamer: false,
                    keuken: false,
                    vuilnis: false
                });
                updateManualAssignments({
                    woonkamer: null,
                    keuken: null,
                    vuilnis: null
                });
                
                updateTrackedWeek(trackedWeek + 1);
                logActivity('voltooide week', `Week ${trackedWeek}`, true);
            };

            const clearHistory = () => {
                updateHistory([]);
                setShowClearConfirm(false);
            };

            const adjustWeek = (increment) => {
                const newWeek = Math.max(1, trackedWeek + increment);
                updateTrackedWeek(newWeek);
            };

            const allComplete = tasks.woonkamer && tasks.keuken && tasks.vuilnis;
            const completedCount = Object.values(tasks).filter(Boolean).length;

            const roommatesList = {
                woonkamer: ['Roel', 'Stijn'],
                keuken: ['Tom', 'Maxim'],
                vuilnis: ['Sam']
            };

            // User Picker Modal
            if (showUserPicker) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full">
                            <h2 className="text-2xl font-bold text-gray-800 mb-2 text-center">Wie ben jij?</h2>
                            <p className="text-gray-600 text-center mb-6">Selecteer je naam om te beginnen</p>
                            <div className="space-y-3">
                                {roommates.map(name => (
                                    <button
                                        key={name}
                                        onClick={() => selectUser(name)}
                                        className="w-full p-4 rounded-xl border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition-all font-medium text-gray-700 hover:text-blue-700"
                                    >
                                        {name}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            if (isLoading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
                        <div className="text-center">
                            <div className="text-4xl mb-4">🧹</div>
                            <div className="text-gray-600">Laden...</div>
                        </div>
                    </div>
                );
            }

            const TrackerView = () => (
                <div>
                    {/* User indicator */}
                    <div className="bg-white rounded-xl shadow-md p-3 mb-4 flex items-center justify-between">
                        <div className="flex items-center gap-2">
                            <div className="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-semibold text-sm">
                                {currentUser.charAt(0)}
                            </div>
                            <span className="text-sm text-gray-600">Ingelogd als <span className="font-semibold text-gray-800">{currentUser}</span></span>
                        </div>
                        <button
                            onClick={() => {
                                localStorage.removeItem('currentUser');
                                setShowUserPicker(true);
                            }}
                            className="text-xs text-blue-600 hover:text-blue-700"
                        >
                            Wissel
                        </button>
                    </div>

                    <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
                        <div className="flex justify-between items-start mb-2">
                            <div>
                                <h1 className="text-2xl font-bold text-gray-800">🧹 Schoonmaak</h1>
                                <p className="text-gray-600">Week {trackedWeek} • {getWeekDateRange(trackedWeek, currentYear)}</p>
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setCurrentView('activity')}
                                    className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                                    title="Activiteit"
                                >
                                    <Activity size={20} className="text-gray-600" />
                                </button>
                                <button
                                    onClick={() => setCurrentView('history')}
                                    className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                                    title="Geschiedenis"
                                >
                                    <History size={20} className="text-gray-600" />
                                </button>
                                <button
                                    onClick={() => setCurrentView('edit')}
                                    className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                                    title="Aanpassen"
                                >
                                    <Settings size={20} className="text-gray-600" />
                                </button>
                            </div>
                        </div>
                        <div className="mt-3 flex items-center gap-2">
                            <div className="flex-1 bg-gray-200 rounded-full h-2">
                                <div 
                                    className="bg-green-500 h-2 rounded-full transition-all duration-300"
                                    style={{ width: `${(completedCount / 3) * 100}%` }}
                                />
                            </div>
                            <span className="text-sm font-medium text-gray-700">
                                {completedCount}/3
                            </span>
                        </div>
                    </div>

                    {/* Deadline Banner */}
                    <div className="bg-gradient-to-r from-orange-50 to-red-50 border-l-4 border-orange-500 rounded-lg p-4 mb-4 flex items-center gap-3">
                        <Clock size={24} className="text-orange-600" />
                        <div className="flex-1">
                            <div className="font-semibold text-gray-800">Deadline: Zondag</div>
                            <div className="text-sm text-gray-600">{timeUntilDeadline} resterend</div>
                        </div>
                    </div>

                    <div className="space-y-3 mb-4">
                        {Object.entries(assignments).map(([task, person]) => (
                            <button
                                key={task}
                                onClick={() => toggleTask(task)}
                                className={`w-full p-5 rounded-xl shadow-md transition-all transform active:scale-98 ${
                                    tasks[task] 
                                        ? 'bg-green-500 text-white' 
                                        : 'bg-white text-gray-800 hover:shadow-lg'
                                }`}
                            >
                                <div className="flex items-center justify-between">
                                    <div className="text-left">
                                        <div className="font-semibold text-lg capitalize">
                                            {task === 'woonkamer' ? 'Woonkamer' : task === 'keuken' ? 'Keuken' : 'Doeken/Vuilnis'}
                                        </div>
                                        <div className={`text-sm ${tasks[task] ? 'text-green-100' : 'text-gray-600'}`}>
                                            {person}
                                        </div>
                                    </div>
                                    <div className={`w-8 h-8 rounded-full flex items-center justify-center ${
                                        tasks[task] ? 'bg-white' : 'bg-gray-200'
                                    }`}>
                                        {tasks[task] && <Check size={20} className="text-green-500" />}
                                    </div>
                                </div>
                            </button>
                        ))}
                    </div>

                    <div className="space-y-2">
                        {allComplete ? (
                            <button
                                onClick={() => completeWeek(false)}
                                className="w-full bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl shadow-lg font-semibold hover:from-green-600 hover:to-green-700 transition-all"
                            >
                                ✨ Week Voltooien & Opslaan
                            </button>
                        ) : (
                            <button
                                onClick={() => completeWeek(true)}
                                className="w-full bg-orange-500 hover:bg-orange-600 text-white p-4 rounded-xl shadow-lg font-semibold transition-all flex items-center justify-center gap-2"
                            >
                                <ChevronRight size={20} />
                                Naar Volgende Week (Onvolledig)
                            </button>
                        )}
                    </div>

                    <div className="bg-white rounded-xl shadow-md p-4 mt-4">
                        <h3 className="font-semibold text-gray-700 mb-2">📅 Volgende week:</h3>
                        <div className="space-y-1 text-sm text-gray-600">
                            <div className="flex justify-between">
                                <span>Woonkamer:</span>
                                <span className="font-medium text-gray-800">{nextWeek.woonkamer}</span>
                            </div>
                            <div className="flex justify-between">
                                <span>Keuken:</span>
                                <span className="font-medium text-gray-800">{nextWeek.keuken}</span>
                            </div>
                            <div className="flex justify-between">
                                <span>Doeken/Vuilnis:</span>
                                <span className="font-medium text-gray-800">{nextWeek.vuilnis}</span>
                            </div>
                        </div>
                    </div>
                </div>
            );

            const ActivityView = () => (
                <div>
                    <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
                        <div className="flex items-center gap-3">
                            <button
                                onClick={() => setCurrentView('tracker')}
                                className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                            >
                                <ChevronLeft size={20} />
                            </button>
                            <div>
                                <h1 className="text-2xl font-bold text-gray-800">📊 Activiteit</h1>
                                <p className="text-gray-600">Recente activiteiten</p>
                            </div>
                        </div>
                    </div>

                    {activityLog.length === 0 ? (
                        <div className="bg-white rounded-xl shadow-md p-8 text-center text-gray-500">
                            <Activity size={48} className="mx-auto mb-3 opacity-30" />
                            <p>Nog geen activiteiten</p>
                        </div>
                    ) : (
                        <div className="space-y-2">
                            {activityLog.map((activity, index) => (
                                <div key={index} className="bg-white rounded-xl shadow-md p-4">
                                    <div className="flex items-start gap-3">
                                        <div className="w-8 h-8 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center font-semibold text-sm flex-shrink-0">
                                            {activity.user.charAt(0)}
                                        </div>
                                        <div className="flex-1 min-w-0">
                                            <div className="text-sm">
                                                <span className="font-semibold text-gray-800">{activity.user}</span>
                                                <span className="text-gray-600"> {activity.action} </span>
                                                <span className="font-medium text-gray-800">{activity.task}</span>
                                            </div>
                                            <div className="text-xs text-gray-500 mt-1">
                                                {formatTimestamp(activity.timestamp)}
                                            </div>
                                        </div>
                                        {activity.status !== undefined && (
                                            <div className={`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${
                                                activity.status ? 'bg-green-100' : 'bg-gray-100'
                                            }`}>
                                                {activity.status ? (
                                                    <Check size={14} className="text-green-600" />
                                                ) : (
                                                    <X size={14} className="text-gray-400" />
                                                )}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );

            const HistoryView = () => (
                <div>
                    <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <button
                                    onClick={() => setCurrentView('tracker')}
                                    className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                                >
                                    <ChevronLeft size={20} />
                                </button>
                                <div>
                                    <h1 className="text-2xl font-bold text-gray-800">📜 Geschiedenis</h1>
                                    <p className="text-gray-600">{history.length} voltooide weken</p>
                                </div>
                            </div>
                            {history.length > 0 && (
                                <button
                                    onClick={() => setShowClearConfirm(true)}
                                    className="p-2 hover:bg-red-50 rounded-lg transition-colors text-red-600"
                                    title="Wis geschiedenis"
                                >
                                    <X size={20} />
                                </button>
                            )}
                        </div>
                    </div>

                    {showClearConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
                                <h3 className="text-xl font-bold text-gray-800 mb-2">Geschiedenis Wissen?</h3>
                                <p className="text-gray-600 mb-6">
                                    Weet je zeker dat je alle {history.length} week{history.length !== 1 ? 'en' : ''} wilt wissen? Dit kan niet ongedaan worden.
                                </p>
                                <div className="flex gap-3">
                                    <button
                                        onClick={() => setShowClearConfirm(false)}
                                        className="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 p-3 rounded-xl font-medium transition-all"
                                    >
                                        Annuleren
                                    </button>
                                    <button
                                        onClick={clearHistory}
                                        className="flex-1 bg-red-500 hover:bg-red-600 text-white p-3 rounded-xl font-medium transition-all"
                                    >
                                        Wissen
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {history.length === 0 ? (
                        <div className="bg-white rounded-xl shadow-md p-8 text-center text-gray-500">
                            <History size={48} className="mx-auto mb-3 opacity-30" />
                            <p>Nog geen voltooide weken</p>
                        </div>
                    ) : (
                        <div className="space-y-3">
                            {history.map((week, index) => {
                                const allTasksComplete = Object.values(week.tasks).every(Boolean);
                                const completedTaskCount = Object.values(week.tasks).filter(Boolean).length;
                                
                                return (
                                    <div key={index} className="bg-white rounded-xl shadow-md p-5">
                                        <div className="flex justify-between items-start mb-3">
                                            <div>
                                                <div className="font-semibold text-gray-800">Week {week.weekNumber}</div>
                                                <div className="text-sm text-gray-600">{week.dateRange}</div>
                                            </div>
                                            <div className="flex gap-1">
                                                {allTasksComplete ? (
                                                    <span className="text-green-500 text-sm font-medium flex items-center gap-1">
                                                        <Check size={16} /> Compleet
                                                    </span>
                                                ) : (
                                                    <span className="text-orange-500 text-sm font-medium flex items-center gap-1">
                                                        {completedTaskCount}/3 Taken
                                                    </span>
                                                )}
                                            </div>
                                        </div>
                                        <div className="space-y-2">
                                            {Object.entries(week.assignments).map(([task, person]) => (
                                                <div key={task} className="flex items-center justify-between text-sm">
                                                    <span className="text-gray-600 capitalize">
                                                        {task === 'woonkamer' ? 'Woonkamer' : task === 'keuken' ? 'Keuken' : 'Doeken/Vuilnis'}:
                                                    </span>
                                                    <div className="flex items-center gap-2">
                                                        <span className="font-medium text-gray-800">{person}</span>
                                                        {week.tasks[task] ? (
                                                            <div className="w-6 h-6 rounded-full bg-green-100 flex items-center justify-center">
                                                                <Check size={16} className="text-green-600" />
                                                            </div>
                                                        ) : (
                                                            <div className="w-6 h-6 rounded-full bg-red-100 flex items-center justify-center">
                                                                <X size={16} className="text-red-600" />
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    )}
                </div>
            );

            const EditView = () => (
                <div>
                    <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
                        <div className="flex items-center gap-3">
                            <button
                                onClick={() => setCurrentView('tracker')}
                                className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                            >
                                <ChevronLeft size={20} />
                            </button>
                            <div>
                                <h1 className="text-2xl font-bold text-gray-800">⚙️ Instellingen</h1>
                                <p className="text-gray-600">Aanpassen en beheren</p>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white rounded-xl shadow-md p-5 mb-4">
                        <h3 className="font-semibold text-gray-700 mb-3">📅 Week Aanpassen</h3>
                        <div className="flex items-center justify-between mb-3">
                            <div>
                                <div className="text-2xl font-bold text-gray-800">Week {trackedWeek}</div>
                                <div className="text-sm text-gray-600">{getWeekDateRange(trackedWeek, currentYear)}</div>
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => adjustWeek(-1)}
                                    className="w-10 h-10 rounded-lg bg-gray-100 hover:bg-gray-200 flex items-center justify-center font-bold text-gray-700 transition-all"
                                >
                                    -
                                </button>
                                <button
                                    onClick={() => adjustWeek(1)}
                                    className="w-10 h-10 rounded-lg bg-gray-100 hover:bg-gray-200 flex items-center justify-center font-bold text-gray-700 transition-all"
                                >
                                    +
                                </button>
                            </div>
                        </div>
                        <button
                            onClick={() => {
                                const currentCalendarWeek = getWeekNumber(new Date());
                                updateTrackedWeek(currentCalendarWeek);
                            }}
                            className="w-full bg-blue-50 hover:bg-blue-100 text-blue-700 p-3 rounded-lg text-sm font-medium transition-all"
                        >
                            Reset naar Huidige Kalenderweek
                        </button>
                    </div>

                    <div className="bg-white rounded-xl shadow-md p-5 mb-4">
                        <h3 className="font-semibold text-gray-700 mb-3">👥 Wie doet wat deze week?</h3>
                        <div className="space-y-4">
                            {Object.entries(roommatesList).map(([task, people]) => (
                                <div key={task}>
                                    <label className="block text-sm font-medium text-gray-700 mb-2 capitalize">
                                        {task === 'woonkamer' ? 'Woonkamer' : task === 'keuken' ? 'Keuken' : 'Doeken/Vuilnis'}
                                    </label>
                                    <div className="flex gap-2">
                                        {people.map(person => (
                                            <button
                                                key={person}
                                                onClick={() => {
                                                    const newAssignments = {
                                                        ...manualAssignments,
                                                        [task]: person
                                                    };
                                                    updateManualAssignments(newAssignments);
                                                }}
                                                className={`flex-1 p-3 rounded-lg border-2 transition-all ${
                                                    assignments[task] === person
                                                        ? 'border-blue-500 bg-blue-50 text-blue-700 font-medium'
                                                        : 'border-gray-200 hover:border-gray-300'
                                                }`}
                                            >
                                                {person}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                        <button
                            onClick={() => {
                                updateManualAssignments({
                                    woonkamer: null,
                                    keuken: null,
                                    vuilnis: null
                                });
                            }}
                            className="w-full mt-4 bg-gray-100 hover:bg-gray-200 text-gray-700 p-3 rounded-lg font-medium transition-all"
                        >
                            Reset naar Automatische Rotatie
                        </button>
                    </div>

                    <div className="bg-white rounded-xl shadow-md p-5 mb-4">
                        <h3 className="font-semibold text-gray-700 mb-3">🗑️ Geschiedenis Beheren</h3>
                        <p className="text-sm text-gray-600 mb-3">
                            Je hebt {history.length} week{history.length !== 1 ? 'en' : ''} in de geschiedenis
                        </p>
                        <button
                            onClick={() => setShowClearConfirm(true)}
                            disabled={history.length === 0}
                            className={`w-full p-3 rounded-lg font-medium transition-all ${
                                history.length === 0
                                    ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
                                    : 'bg-red-50 hover:bg-red-100 text-red-700'
                            }`}
                        >
                            Wis Alle Geschiedenis
                        </button>
                    </div>

                    {showClearConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
                                <h3 className="text-xl font-bold text-gray-800 mb-2">Geschiedenis Wissen?</h3>
                                <p className="text-gray-600 mb-6">
                                    Weet je zeker dat je alle {history.length} week{history.length !== 1 ? 'en' : ''} wilt wissen? Dit kan niet ongedaan worden.
                                </p>
                                <div className="flex gap-3">
                                    <button
                                        onClick={() => setShowClearConfirm(false)}
                                        className="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 p-3 rounded-xl font-medium transition-all"
                                    >
                                        Annuleren
                                    </button>
                                    <button
                                        onClick={clearHistory}
                                        className="flex-1 bg-red-500 hover:bg-red-600 text-white p-3 rounded-xl font-medium transition-all"
                                    >
                                        Wissen
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="bg-blue-50 border border-blue-200 rounded-xl p-4">
                        <p className="text-sm text-blue-800">
                            💡 <strong>Standaard rotatie:</strong> Roel ↔ Stijn voor Woonkamer en Tom ↔ Maxim voor Keuken per week
                        </p>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 pb-8">
                    <div className="max-w-md mx-auto">
                        {currentView === 'tracker' && <TrackerView />}
                        {currentView === 'activity' && <ActivityView />}
                        {currentView === 'history' && <HistoryView />}
                        {currentView === 'edit' && <EditView />}
                    </div>
                </div>
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CleaningTracker />);
    </script>
</body>
</html>
